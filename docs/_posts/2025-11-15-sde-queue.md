---
title: Queue/Deque/Stack æ ¸å¿ƒæ¦‚å¿µä¸å¸¸ç”¨å®ç°
layout: post
date: 2025-11-15
categories: [Java & SDE]
tags: [Stack, Algorithm, Amortized Analysis]
---

# ğŸ“˜ **

---

# 1. Queueï¼ˆé˜Ÿåˆ—ï¼‰

**FIFOï¼šFirst In First Out**

å¸¸è§æ¥å£åˆ†ä¸ºä¸¤ç»„ï¼š

| æ“ä½œ | æŠ›å¼‚å¸¸ | è¿”å›ç‰¹æ®Šå€¼ï¼ˆæ¨èï¼‰ |
|------|--------|---------------------|
| æ’å…¥å…ƒç´  | `add()` | `offer()` |
| åˆ é™¤å…ƒç´  | `remove()` | `poll()` |
| æŸ¥çœ‹é˜Ÿé¦– | `element()` | `peek()` |

ğŸ“Œ **åŒºåˆ«ï¼š**  
- ç¬¬ä¸€ç»„åœ¨é˜Ÿåˆ—ä¸ºç©ºæ—¶ **æŠ›å¼‚å¸¸**  
- ç¬¬äºŒç»„åœ¨é˜Ÿåˆ—ä¸ºç©ºæ—¶ **è¿”å› null**  
ğŸ‘‰ å®é™…å¼€å‘ 99% ä½¿ç”¨ç¬¬äºŒç»„ï¼ˆ`offer` / `poll` / `peek`ï¼‰

### âœ” Queue åˆ›å»ºæ–¹å¼

```java
Queue<Integer> queue = new ArrayDeque<>();
```

`ArrayDeque` æ€§èƒ½å¥½ï¼Œå‡ ä¹æ€»æ˜¯ä¼˜äº `LinkedList`ã€‚

---

# 2. Dequeï¼ˆåŒç«¯é˜Ÿåˆ—ï¼‰

**åŒç«¯æ’å…¥ / åˆ é™¤ï¼šæ—¢èƒ½å½“ Queueï¼ˆFIFOï¼‰ï¼Œä¹Ÿèƒ½å½“ Stackï¼ˆLIFOï¼‰ã€‚**

```java
Deque<Integer> deque = new ArrayDeque<>();
```

### å¸¸ç”¨ API

| æ“ä½œ | é˜Ÿå¤´ | é˜Ÿå°¾ |
|------|------|-------|
| æ’å…¥ | `offerFirst()` | `offerLast()` |
| æŸ¥çœ‹ | `peekFirst()` | `peekLast()` |
| åˆ é™¤ | `pollFirst()` | `pollLast()` |

ğŸ“Œ **Deque èƒ½åš Queue çš„æ‰€æœ‰äº‹ï¼Œä½†åè¿‡æ¥ä¸è¡Œã€‚**

ğŸ’¡ ä¸ºä¿æŒæ¸…æ™°æ€§ï¼Œä¸è¦å†™ï¼š
```java
Deque<Integer> queue = new ArrayDeque<>();
```
è¦ä¹ˆå½“ Queueï¼Œç”¨ `Queue` æ¥å£ï¼›è¦ä¹ˆå½“ Stackï¼Œç”¨ `Deque` æ˜ç¡®è¯­ä¹‰ã€‚

---

# 3. Stackï¼ˆæ¨èç”¨ Deque æ¥å®ç°ï¼‰

Java å®˜æ–¹çš„ `Stack` ç±»å·²ç»è¿‡æ—¶ï¼Œä¸å»ºè®®ä½¿ç”¨ã€‚

**æ­£ç¡®æ–¹å¼ï¼š**

```java
Deque<Integer> stack = new ArrayDeque<>();
```

---

# 4. æ—¶é—´å¤æ‚åº¦ä¸é™åˆ¶

### âœ” æ—¶é—´å¤æ‚åº¦
- `offer()` / `poll()` / `peek()`  
- `push()` / `pop()`  

éƒ½æ˜¯ **O(1)**

### âœ” é™åˆ¶
- **Deque ä¸èƒ½å­˜ null**ï¼ˆå› ä¸º null ä¼šå’Œè¿”å› null çš„â€œç©ºé˜Ÿåˆ—â€å†²çªï¼‰
- `Integer` æ˜¯å¯¹è±¡ï¼ˆåŒ…è£…ç±»å‹ï¼‰  
  `int` æ˜¯ primitive type  
  â€”â€”å½±å“å†…å­˜å¼€é”€å’Œ cache locality

---

# 5. Stack Implementationï¼ˆLinked List å®ç°ï¼‰

ä½¿ç”¨å•é“¾è¡¨ï¼Œ**head ä½œä¸ºæ ˆé¡¶**ï¼ˆpush/pop éƒ½æ˜¯ O(1)ï¼‰ã€‚

### åŸºæœ¬ç»“æ„
```java
public class Stack {
    private ListNode head;
    private int size;

    public Stack() {
        head = null;
        size = 0;
    }

    public Integer pop() {
        if (head == null) return null;
        int val = head.value;
        head = head.next;
        size--;
        return val;
    }

    public Integer peek() {
        return head == null ? null : head.value;
    }

    public boolean push(int ele) {
        ListNode node = new ListNode(ele);
        node.next = head;
        head = node;
        size++;
        return true;
    }

    public int size() { return size; }

    public boolean isEmpty() { return size == 0; }
}
```

---

# 6. Stack Implementationï¼ˆArray å®ç°ï¼‰

ç”¨æ•°ç»„æ¨¡æ‹Ÿæ ˆï¼Œ`head` æŒ‡å‘â€œæ ˆé¡¶â€ã€‚

åˆå§‹åŒ–ï¼š

```java
head = -1;
```

### å®ç°
```java
public class Stack {
    private int[] array;
    private int head;

    public Stack(int capacity) {
        array = new int[capacity];
        head = -1;
    }

    public Integer pop() {
        return isEmpty() ? null : array[head--];
    }

    public Integer peek() {
        return isEmpty() ? null : array[head];
    }

    public boolean push(int ele) {
        if (isFull()) return false;
        array[++head] = ele;
        return true;
    }

    public boolean isEmpty() {
        return head == -1;
    }

    public boolean isFull() {
        return head + 1 == array.length;
    }

    public int size() {
        return head + 1;
    }
}
```

ğŸ‘‰ ä¸‰ç›®è¿ç®—ç¬¦ç‰ˆæœ¬ `pop()` ç¤ºä¾‹ï¼š  
```java
return isEmpty() ? null : array[head--];
```

---

# 7. Queue Implementationï¼ˆLinked List å®ç°ï¼‰

å•é“¾è¡¨å³å¯ï¼Œç»´æŠ¤ **headï¼ˆé˜Ÿå¤´ï¼‰** å’Œ **tailï¼ˆé˜Ÿå°¾ï¼‰**

### åŸåˆ™  
- `push()` åœ¨å°¾éƒ¨æ’å…¥  
- `pop()` ä»å¤´éƒ¨åˆ é™¤  

### å®ç°
```java
public class Queue {
    private ListNode head;
    private ListNode tail;
    private int size;

    public Integer pop() {
        if (head == null) return null;

        int val = head.value;
        head = head.next;

        if (head == null) tail = null; // åˆšå¥½åˆ ç©º
        size--;
        return val;
    }

    public Integer peek() {
        return head == null ? null : head.value;
    }

    public boolean push(int ele) {
        ListNode node = new ListNode(ele);

        if (head == null) {
            head = tail = node;
        } else {
            tail.next = node;
            tail = node;
        }
        size++;
        return true;
    }

    public boolean isEmpty() { return size == 0; }
    public int size() { return size; }
}
```

---

# 8. Queue Implementationï¼ˆArray å®ç°ï¼šå¾ªç¯æ•°ç»„ / Ring Bufferï¼‰

å¾ªç¯æ•°ç»„è§£å†³ â€œå°¾éƒ¨åˆ°äº†æ•°ç»„å°½å¤´æ€ä¹ˆåŠâ€ã€‚

**å…³é”®æ€æƒ³ï¼š**
- `head` æŒ‡å‘é˜Ÿå¤´  
- `tail` æŒ‡å‘é˜Ÿå°¾çš„ä¸‹ä¸€ä¸ªä½ç½®ï¼ˆè¡¨ç¤ºå¯æ’å…¥çš„ä½ç½®ï¼‰  
- æ»¡/ç©ºä¸èƒ½ä»…ç”¨ `head==tail` åˆ¤æ–­ï¼Œå› æ­¤éœ€è¦ `size`

### index å¾ªç¯å…¬å¼

```java
head = (head + 1) % array.length;
tail = (tail + 1) % array.length;
```

### å®ç°
```java
public class Queue {
    private int[] array;
    private int head;
    private int tail;
    private int size;

    public Queue(int capacity) {
        array = new int[capacity];
        head = 0;
        tail = 0;
        size = 0;
    }

    public boolean push(int ele) {
        if (isFull()) return false;
        array[tail] = ele;
        tail = (tail + 1) % array.length;
        size++;
        return true;
    }

    public Integer pop() {
        if (isEmpty()) return null;
        int val = array[head];
        head = (head + 1) % array.length;
        size--;
        return val;
    }

    public Integer peek() {
        return isEmpty() ? null : array[head];
    }

    public boolean isEmpty() { return size == 0; }

    public boolean isFull() { return size == array.length; }

    public int size() { return size; }
}
```

---

# ğŸ§  æ€»ç»“

### âœ” ä½¿ç”¨ç­–ç•¥
- å®é™…å¼€å‘ï¼š**Deque > Queue > Stackï¼ˆå¼ƒç”¨ï¼‰**
- é¢è¯•ï¼šLinked List / Array ä¸¤å¥—å®ç°éƒ½è¦ä¼š

### âœ” API é‡ç‚¹
- Queueï¼š`offer/poll/peek`
- Dequeï¼š`offerFirst/offerLast` ä¸å¯¹åº”çš„ `poll/peek`
- Stackï¼š`push/pop/peek`

### âœ” å®ç°é‡ç‚¹
- Stackï¼ˆLLï¼‰ï¼šhead ä½œæ ˆé¡¶
- Stackï¼ˆArrayï¼‰ï¼šhead = -1
- Queueï¼ˆLLï¼‰ï¼šhead å‡ºé˜Ÿ / tail å…¥é˜Ÿ
- Queueï¼ˆArrayï¼‰ï¼šå¾ªç¯æ•°ç»„ `(i+1)%n`

---